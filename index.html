<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ–∫—É–º–µ–Ω—Ç—ã –∫—É—Ä—å–µ—Ä–æ–≤ –ú–µ—Ä–∏–¥–∏–∞–Ω</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen p-4 flex items-center justify-center font-sans">
    <div class="max-w-md w-full bg-white rounded-3xl shadow-2xl p-8">
        <h1 class="text-2xl font-bold text-gray-800 mb-2 text-center uppercase tracking-tight">–ú–µ—Ä–∏–¥–∏–∞–Ω üöõ</h1>
        <p class="text-blue-600 font-bold text-center mb-8 text-sm">–î–û–ö–£–ú–ï–ù–¢–´ –ö–£–†–¨–ï–†–û–í</p>
        
        <form id="uploadForm" class="space-y-6">
            <div>
                <label class="block text-xs font-bold text-gray-400 uppercase mb-2 ml-1">–§–ò–û –ö—É—Ä—å–µ—Ä–∞</label>
                <input type="text" id="fio" required 
                    class="w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl focus:border-blue-500 focus:bg-white outline-none transition-all" 
                    placeholder="–§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ">
            </div>

            <div>
                <label class="block text-xs font-bold text-gray-400 uppercase mb-2 ml-1">–°–∫–∞–Ω-–∫–æ–ø–∏–∏ / –§–æ—Ç–æ</label>
                <div class="relative border-2 border-dashed border-gray-200 rounded-2xl p-8 text-center hover:bg-gray-50 transition-colors">
                    <input type="file" id="photos" multiple accept="image/*" required
                        class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                    <div id="fileStatus" class="space-y-2">
                        <span class="block text-blue-600 font-semibold">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</span>
                        <span class="block text-gray-400 text-xs text-balance">–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ä–∞–∑—É</span>
                    </div>
                </div>
            </div>

            <button type="submit" id="submitBtn" 
                class="w-full bg-blue-700 hover:bg-blue-800 text-white py-4 rounded-2xl font-bold text-lg shadow-lg shadow-blue-200 transition-all active:scale-95">
                –û–¢–ü–†–ê–í–ò–¢–¨ –í –ë–ê–ó–£
            </button>

            <div id="loader" class="hidden">
                <div class="flex items-center justify-center space-x-2 animate-pulse">
                    <div class="w-2 h-2 bg-blue-700 rounded-full"></div>
                    <div class="w-2 h-2 bg-blue-700 rounded-full"></div>
                    <div class="w-2 h-2 bg-blue-700 rounded-full"></div>
                    <span class="text-blue-700 font-bold text-sm uppercase">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...</span>
                </div>
            </div>
        </form>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ n8n –≤ —É–∑–ª–µ Webhook –ø—É—Ç—å –∏–º–µ–Ω–Ω–æ photo-fix
        const WEBHOOK_URL = 'https://n8n.evjn1.ru/webhook/photo-fix';

        const fileInput = document.getElementById('photos');
        const fileStatus = document.getElementById('fileStatus');

        fileInput.onchange = () => {
            if (fileInput.files.length > 0) {
                fileStatus.innerHTML = `<span class="text-green-600 font-bold text-lg">–í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${fileInput.files.length}</span>`;
            }
        };

        document.getElementById('uploadForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            const loader = document.getElementById('loader');
            
            btn.classList.add('hidden');
            loader.classList.remove('hidden');

            const formData = new FormData();
            formData.append('fio', document.getElementById('fio').value);

            const files = fileInput.files;
            for (let i = 0; i < files.length; i++) {
                formData.append('file_' + i, files[i]);
            }

            try {
                const response = await fetch(WEBHOOK_URL, { method: 'POST', body: formData });
                if (response.ok) {
            const fio = document.getElementById('fio').value;
            alert(`‚úÖ –ì–æ—Ç–æ–≤–æ!\n\n–î–æ–∫—É–º–µ–Ω—Ç—ã –∫—É—Ä—å–µ—Ä–∞ ${fio} —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ –±–∞–∑—É "–ú–µ—Ä–∏–¥–∏–∞–Ω".`);
            location.reload();
        } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ' + response.status);
                    resetUI();
                }
            } catch (err) {
                alert('‚ùå –û—à–∏–±–∫–∞ —Å–≤—è–∑–∏! –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ n8n –∑–∞–ø—É—â–µ–Ω (Listen for test event)');
                resetUI();
            }
        };

        function resetUI() {
            document.getElementById('submitBtn').classList.remove('hidden');
            document.getElementById('loader').classList.add('hidden');
        }
    </script>
</body>
</html>